# webservertune-enhance — settings.conf


# ─────────────────────────────────────────────────────────────────────────────
# General
# ─────────────────────────────────────────────────────────────────────────────

[general]
# INFO, WARNING or DEBUG
log_level = "INFO"

# Seconds between file change detection and action
debounce_seconds = 10


# ─────────────────────────────────────────────────────────────────────────────
# Nginx
# ─────────────────────────────────────────────────────────────────────────────

[nginx]
# Days to retain backups in backups/nginx/
backup_retention_days = 30

[nginx.features]
# HTTP/3 support: QUIC listeners, Alt-Svc headers, FastCGI HTTP_HOST fix
http3_enable = false

# QUIC Generic Segmentation Offloading (requires http3_enable = true)
quic_gso_enable = false

# Include overrides/ssl.conf — modern TLS settings
ssl_upgrade = false

# Include overrides/hardening.conf — server hardening rules
server_hardening = false

# Include overrides/cms.conf — WordPress and CMS protection rules
cms_protection = false

# Persistent access logs to /var/www/<UUID>/logs/webserver.log
persistent_logging = false

# Log real visitor IPs via Cloudflare headers (requires persistent_logging = true)
real_ip_logging = false

# FastCGI cache inactive timeout
fastcgi_cache_inactive = "60m"

# FastCGI cache validity period
fastcgi_cache_valid = "60m"

# Maximum upload / request body size
client_max_body_size = "200m"


# ─────────────────────────────────────────────────────────────────────────────
# OLS webserver settings
# ─────────────────────────────────────────────────────────────────────────────

[ols-webserver]
# Days to retain backups in backups/ols/
backup_retention_days = 30

# Top-level keys in httpd_config.conf
[ols-webserver.general]
#cpuAffinity  = "1"
#enableLVE    = "0"
#inMemBufSize = "128M"

# tuning block
[ols-webserver.tuning]
#sndBufSize         = "512K"
#rcvBufSize         = "512K"
#useAIO             = "3"
#AIOBlockSize       = "3"
#quicEnable         = "1"
#quicVersions       = "h3"
#quicCongestionCtrl = "2"

# errorlog block
["ols-webserver"."errorlog logs/error.log"]
#logLevel        = "WARN"
#debugLevel      = "0"
#rollingSize     = "25M"
#keepDays        = "7"
#compressArchive = "1"
#enableStderrLog = "1"

# accesslog block
["ols-webserver"."accesslog logs/access.log"]
#rollingSize     = "25M"
#keepDays        = "7"
#compressArchive = "1"


# ─────────────────────────────────────────────────────────────────────────────
# OLS 503 auto-fix
# ─────────────────────────────────────────────────────────────────────────────

[ols-503fix]
# Enhance API endpoint and bearer token
enhance_url   = "https://example.com/api"
enhance_token = ""

# Sliding window in seconds for 503 counting
window_seconds = 30

# Minimum 503 count within window before evaluating a restart
min_503_count = 5

# Minimum percentage of last last_n_requests that must be 503s to trigger
min_503_percent = 50

# Request sample size for percentage calculation
last_n_requests = 10

# Cooldown between restarts for the same site (seconds)
cooldown_seconds = 60

# Log polling interval (seconds)
scan_interval = 1
